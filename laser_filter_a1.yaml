scan_filter_chain:
  # 1. 距离范围滤波 - 过滤超出有效范围的点
  - name: range_filter
    type: laser_filters/LaserScanRangeFilter
    params:
      use_message_range_limits: false
      lower_threshold: 0.20          # A1最小有效距离 0.15m + 安全余量
      upper_threshold: 8.0           # 狭窄空间限制到8米
      lower_replacement_value: .inf
      upper_replacement_value: .inf
  
  # 2. 强度滤波 - 过滤低质量反射点
  - name: intensity_filter
    type: laser_filters/LaserScanIntensityFilter
    params:
      lower_threshold: 100           # A1强度范围0-255
      upper_threshold: 255
      disp_histogram: 0
  
  # 3. 散斑滤波 - 去除孤立噪点（第一次）
  - name: speckle_filter_1
    type: laser_filters/LaserScanSpeckleFilter
    params:
      filter_type: 1                 # 1=Range based
      max_range: 8.0
      max_range_difference: 0.15     # 相邻点最大距离差
      filter_window: 2               # 检查前后各2个点
  
  # 4. 散斑滤波 - 二次过滤（替代中值滤波的平滑效果）
  - name: speckle_filter_2
    type: laser_filters/LaserScanSpeckleFilter
    params:
      filter_type: 1
      max_range: 8.0
      max_range_difference: 0.10     # 更严格的阈值
      filter_window: 1
  
  # 5. 机器人本体滤波 - 过滤机器人自身
  - name: box_filter
    type: laser_filters/LaserScanBoxFilter
    params:
      box_frame: base_link           # 相对于机器人本体坐标系
      min_x: -0.10                  # 过滤范围（单位：米）
      max_x: 0.10
      min_y: -0.05
      max_y: 0.05
      min_z: -0.05
      max_z: 0.05
      invert: true                   # true=保留框外的点，过滤框内
